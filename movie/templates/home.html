{% load static %}
<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Movie Streaming</title>
    <link rel="stylesheet" href="{% static 'style.css' %}">
    <style>
        /* Body & Font */
        body {
            font-family: 'Segoe UI', sans-serif;
            background-color: #000;
            color: #fff;
            margin: 0;
            padding-top: 80px;
            scroll-behavior: smooth;
        }
        section { scroll-margin-top: 30px; }

        /* Navbar */
        .navbar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: fixed;
            top: 0;
            width: 100%;
            padding: 0 20px;
            z-index: 100;
            background: transparent;
        }
        .logo {
            color: #fff;
            font-size: 24px;
            font-weight: bold;
        }
        .nav-links {
            display: flex;
            gap: 40px;
        }
        .nav-links a {
            color: #ccc;
            text-decoration: none;
            transition: 0.3s;
        }
        .nav-links a.active,
        .nav-links a:hover {
            color: #fff;
            font-weight: 600;
            border-bottom: 2px solid #e50914;
        }

        /* Hamburger */
        .hamburger {
            display: none;
            flex-direction: column;
            gap: 5px;
            cursor: pointer;
        }
        .hamburger span {
            width: 25px;
            height: 3px;
            background: #fff;
            border-radius: 2px;
            transition: 0.3s;
        }
        .hamburger.active span:nth-child(1) {
            transform: rotate(45deg) translate(5px,5px);
        }
        .hamburger.active span:nth-child(2) { opacity: 0; }
        .hamburger.active span:nth-child(3) {
            transform: rotate(-45deg) translate(5px,-5px);
        }

        /* Mobile nav */
        @media(max-width:768px){
            .hamburger { display: flex; }
            .nav-links {
                position: fixed;
                top: 0;
                right: -100%;
                width: 250px;
                height: 100vh;
                flex-direction: column;
                gap: 30px;
                background-color: rgba(0,0,0,0.3); /* transparent black */
                backdrop-filter: blur(5px);
                padding-top: 80px;
                transition: right 0.3s ease;
                z-index: 99;
            }
            .nav-links.active { right: 0; }
            .nav-links a { font-size: 18px; }
        }

        /* Typewriter animation */

        /* Grids */
        .poster-grid, .movie-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(280px,1fr)); gap:25px; }
        .poster-card, .movie-card { text-align:center; transition: transform 0.3s ease, box-shadow 0.3s ease; }
        .poster-card img, .movie-card img { width:100%; border-radius:10px; cursor:pointer; }
        .poster-card:hover, .movie-card:hover { transform: scale(1.05); box-shadow:0 8px 20px rgba(255,255,255,0.2); }

        /* Movie Section */
        .movie-section { padding:20px 60px; }
        .movie-section h2 { margin-bottom:20px; text-align:center; color:#ff0000; letter-spacing:2px; }
        .movie-card h3 { margin:10px 0 5px; font-size:18px; }
        .movie-card p { margin:0; color:#aaa; font-size:14px; }

        /* Contact Section */
        .contact-container { display:flex; justify-content:space-between; align-items:center; width:100%; height:540px; background-color:#000; padding:20px; }
        .logo_title { text-align:right; letter-spacing:2px; font-family:monospace; font-size:25px; padding:10px 100px 0 10px; animation: blink-animation 2s steps(1,start) infinite; color:#ccc; font-weight:bold; }
        @keyframes blink-animation { 0%,50%,100%{opacity:1;}25%,75%{opacity:0;} }
        .contact-avatar img { margin-left:120px; width:350px; height:350px; box-shadow:1px 1px 6px 6px white; border-radius:50%; margin-bottom:10px; }
        .contact-form { overflow:hidden; margin-right:160px; width:420px; max-width:100%; height:430px; background:linear-gradient(145deg, rgba(255,255,255,0.05), rgba(255,255,255,0.02)); backdrop-filter: blur(10px); border:1px solid rgba(255,255,255,0.2); border-radius:15px; box-shadow:0 8px 32px rgba(0,0,0,0.3); padding:10px; color:#fff; display:flex; flex-direction:column; justify-content:center; }
        .contact-form h3 { text-align:center; font-size:20px; letter-spacing:2px; margin-top:10px; margin-bottom:5px; }
        .contact-form .form-group label { color:#ddd; margin-bottom:10px; font-weight:500; }
        .contact-form .form-control { width:400px; padding:5px; background-color:rgba(255,255,255,0.1); border:1px solid rgba(255,255,255,0.3); border-radius:8px; color:#fff; font-size:14px; margin:5px; backdrop-filter:blur(5px); }
        .contact-form .btn-submit { width:410px; padding:10px; background-color:#ccc; border:none; border-radius:8px; color:#333; font-size:16px; cursor:pointer; transition:0.3s ease; margin-left:5px; margin-bottom:10px; }
        .contact-form .btn-submit:hover { background-color:rgba(230,0,0,0.9); color:white; }
        .success-message { width:420px; text-align:center; background-color:#008000; padding:10px; border-radius:10px; }

        /* Footer */
        footer{ padding:0 20px; background-color:#000; text-align:center; color:#ccc; }
        footer small{ font-weight:200; padding-bottom:30px; }

        /* Animate-on-scroll */
        .fade-in { opacity:0; transform:translateY(30px); animation: fadeInUp 1s forwards; }
        .stagger { opacity:0; transform:translateY(20px); animation: fadeInUpStagger 0.6s forwards; }
        @keyframes fadeInUp { to{opacity:1; transform:translateY(0);} }
        @keyframes fadeInUpStagger { to{opacity:1; transform:translateY(0);} }

        /* Responsive */
        @media(max-width:768px){
            .poster-grid,.movie-grid { grid-template-columns: repeat(auto-fill,minmax(150px,1fr)); gap:15px; }
            .poster-card img { height:300px; }
            .contact-avatar img { width:250px; height:250px; margin-left:0; }
            .contact-form { width:90%; margin-right:0; height:auto; }
            .contact-container { flex-direction:column; height:auto; gap:20px; padding:20px; }
        }
    </style>
</head>
<body>

<header class="navbar">
    <div class="logo">STREAMING</div>
    <div class="hamburger" id="hamburger"><span></span><span></span><span></span></div>
    <nav class="nav-links" id="nav-links">
        <a href="#home" class="active">Home</a>
        <a href="#movies">Movies</a>
        <a href="#contact">Contact</a>
        <a href="{% url 'logout' %}">Log Out</a>
    </nav>
</header>

<main>
    <!-- Home / Upcoming -->
    <section id="home" class="upcoming">
        <h2 class="typewriter">UPCOMING..</h2>
        <div class="poster-grid">
            {% for poster in upcoming %}
            <div class="poster-card fade-in">
                <a href="{{ poster.link }}" target="_blank"><img src="{{ poster.poster.url }}" alt="Upcoming Movie"></a>
            </div>
            {% empty %}<p class="fade-in">No movies available.</p>{% endfor %}
        </div>
    </section>

    <!-- Movies -->
    <section id="movies" class="movie_page">
        <section class="movie-section">
            <h2 class="fade-in">MARVEL STUDIO</h2>
            <div class="movie-grid">
                {% for movie in movies %}
                <div class="movie-card fade-in">
                    <a href="{% url 'movie:movie_detail' 'marvel' movie.id %}">
                        <img src="{{ movie.poster.url }}" alt="{{ movie.title }}">
                    </a>
                    <h3>{{ movie.title }}</h3>
                    <p>{{ movie.year }}</p>
                </div>
                {% empty %}<p class="fade-in">No movies available.</p>{% endfor %}
            </div>
        </section>
        <section class="movie-section">
            <h2 class="fade-in">DC STUDIO</h2>
            <div class="movie-grid">
                {% for movie in movies2 %}
                <div class="movie-card fade-in">
                    <a href="{% url 'movie:movie_detail' 'dc' movie.id %}">
                        <img src="{{ movie.poster.url }}" alt="{{ movie.title }}">
                    </a>
                    <h3>{{ movie.title }}</h3>
                    <p>{{ movie.year }}</p>
                </div>
                {% empty %}<p class="fade-in">No movies available.</p>{% endfor %}
            </div>
        </section>
    </section>

    <!-- Contact -->
    <section id="contact" class="contact-section">
        <div class="contact-container">
            <div class="contact-avatar fade-in">
                <h3 class="logo_title">Contact Me!</h3>
                <img src="{% static 'image/avatar.png' %}" alt="profile">
            </div>
        <section>
            {% if contact_msg %}
                <p class="success-message">{{ contact_msg }}</p>
            {% endif %}
            <div class="contact-form fade-in">
                <h3>Inquiry</h3>
                <form method="post">{% csrf_token %}
                    {% for field in form %}
                    <div class="form-group mb-3">
                        {{ field.label_tag }}{{ field }}
                        {% if field.errors %}<small class="text-danger">{{ field.errors|striptags }}</small>{% endif %}
                    </div>
                    {% endfor %}
                    <button type="submit" class="btn-submit">Send</button>
                </form>
            </div>
        </section>
        </div>
    </section>
</main>

<footer><small>&copy; puffin</small></footer>

<script>
    // Hamburger toggle
    const hamburger = document.getElementById('hamburger');
    const navLinks = document.getElementById('nav-links');

    hamburger.addEventListener('click', () => {
        hamburger.classList.toggle('active');
        navLinks.classList.toggle('active');
    });

    // Close menu when clicking a link
    document.querySelectorAll('.nav-links a').forEach(link => {
        link.addEventListener('click', () => {
            hamburger.classList.remove('active');
            navLinks.classList.remove('active');
        });
    });

    // Animate on scroll
    function animateOnScroll() {
        const elements = document.querySelectorAll('.fade-in');
        const windowHeight = window.innerHeight;
        elements.forEach(el => {
            const position = el.getBoundingClientRect().top;
            if(position < windowHeight - 50){ el.classList.add('animated'); }
        });
    }
    window.addEventListener('scroll', animateOnScroll);
    window.addEventListener('load', animateOnScroll);

    // Scrollspy
    const sections = document.querySelectorAll("main > section");
    const navLinksArr = document.querySelectorAll(".nav-links a");
    window.addEventListener("scroll", () => {
        let current = "";
        sections.forEach(section => {
            const sectionTop = section.offsetTop - 100;
            const sectionHeight = section.offsetHeight;
            if(window.scrollY >= sectionTop && window.scrollY < sectionTop + sectionHeight){
                current = section.getAttribute("id");
            }
        });
        navLinksArr.forEach(link => {
            link.classList.remove("active");
            if(link.getAttribute("href") === `#${current}`){ link.classList.add("active"); }
        });
    });

    // Auto scroll to home
    window.addEventListener("load", () => { if (!window.location.hash) window.location = "#home"; });
</script>
</body>
</html>
